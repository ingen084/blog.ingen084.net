---
title: "KyoshinEewViewer for ingen を使いこなそう！"
category: "防災"
tags: ["KEVi", "ソフトウェア"]
date: 2023-05-30 00:00:00 +09:00

permalink: /posts/20230530-kevi-tips
---

僕は [KyoshinEewViewer for ingen](https://svs.ingen084.net/kyoshineewviewer/) というアプリを趣味で開発しています。  
簡単に説明すると、緊急地震速報や地震情報、津波情報などを表示するアプリです。  
今年9月で初公開から4年になるというのもありカスタマイズできる内容が多くなってきたため、この機会に作者が想定している利用方法･よくある質問･よくありそうな質問をまとめてみたいと思います。

この情報は2023年5月末時点での情報になりますのでご注意ください。

## アプリ全体･各機能共通

### アプリが重い/緊急地震速報発表に重くなる

このアプリではGPUを使用して地図などを描画します。そのためノートパソコンなど、グラフィック性能が低い端末上では重くなることがあります。  
また、マップ移動時や緊急地震速報発表時などはディスプレイのFPSに合わせて画面を更新しようとするため、PCの性能によっては重くなってしまうことがあります。  
重くなってしまう場合は以下の設定を変更してみてください。

- `外観･基本設定` -> `フレームスキップ` の数値をあげる
    - 意図的にFPSを下げることで負荷を減らします。
- `地図` -> `ミニマップを表示する` をオフにする
    - オフにすることで左上のマップが表示されなくなりますが、処理は軽くなります。
- `地図` -> `自動で拡大させる際にアニメーションを行う` をオフにする
    - オフにすることで自動で地図を移動したときのアニメーションがなくなり、負荷が軽減されます。
- `外観･基本設定` -> `ウィンドウの拡大率` を上げる
    - ウィンドウの拡大率を上げることで、ウィンドウ内の文字やアイコンが大きくなるのに合わせ地図の表示範囲が狭くなり、負荷が軽減されます。
    - 特に雨雲レーダー機能などでは顕著に効果が現れると思います。

また、地震発生時など突発的に負荷が高くなるタイミングなどにおいて、複数のアプリを併用しているときに他のアプリの処理が優先され正常に動作しなくなることがあります。  
JQuake などのアプリは自身のプロセスの優先度を高くし起動するため、そういったアプリに処理が優先されてしまうことが原因です。

![image](https://gyazo.ingen084.net/data/3e4bf1159232f6f1060027875e22e5bc.png)  
同様の優先度で処理させたい場合はタスクマネージャから手動で優先度を変更することができます。  
将来的に自動で優先度を設定する機能を提供予定です。

### コンテンツが大きすぎる･小さすぎる

現状ではウィンドウサイズに応じてUIの変化を行うような仕様になっていないため、小さいウィンドウサイズではごちゃごちゃしてしまいます。  
![image](https://gyazo.ingen084.net/data/13f8441b9d9f667c5f0e0a1a7b53554f.png)

そんなときは `外観･基本設定` から `ウィンドウの拡大率` を調整してみましょう。  
![image](https://gyazo.ingen084.net/data/910b05b6fc7632853ae00cebf8592b55.png)  
文字が小さくなってしまいますが、みやすさについてはかなり改善されると思います。  
逆に、大きなモニタなどに向けて拡大率をあげることもできますのでお試しください。

### 必要な情報を選択する

このアプリでは `機能設定` から必要な機能を選択することができます。  
![image](https://gyazo.ingen084.net/data/3fc388575f0f7876828ddee794d31cd9.png)

このスクリーンショットではじめて雨雲レーダー機能があることを知った方もいらっしゃるかもしれません。  
デフォルトでは、 `強震モニタ` `地震情報` `津波情報` が有効になっていますが、見ない情報･不要な情報は積極的にオフにしていきましょう。

今後もデフォルトオフになっている機能は増えていきますので、アップデート履歴などはチェックしてみてくださいね。

### 情報を自動で切り替える

揺れが検知されたら強震モニタを表示させて、地震情報を受信したら地震情報を表示させる、といった操作は煩雑ですね。  
情報の発表時に自動で情報を切り替える設定があります。

![image](https://gyazo.ingen084.net/data/506902d8fb5168d92c0efad84261ac20.png)

揺れの検知以外にも、 `緊急地震速報` `地震情報` `津波情報` に設定がありますのでぜひ設定してみてください。  
もちろんですが、 **該当する機能が無効になっている場合は自動で切り替わりません** のでご注意ください。

## 音声再生機能

このアプリでは特定の条件で音声を再生することができますが、設定方法が少し特殊なため解説します。

### 基本的な使い方

![image](https://gyazo.ingen084.net/data/609616835afc7d01da21198a69ec5e1b.png)  
**チェックが入り、細かな設定が表示されている場合が有効、表示されていない場合は無効** になります。  
ファイルを指定したあとでも **チェックを外してしまうと音声は再生されません** のでご注意ください。

![image](https://gyazo.ingen084.net/data/08881fcbf3ab37fed27ad85e3d1f3dfb.png)  
フォルダのアイコンで再生させたい音声を選び、右側の三角ボタンでサンプル音声を再生することができます。

`重複` チェックボックスについては音声が連続して再生された場合に重複して音声を再生するか、再生中の音声を停止して再生し直すかを選択することができます。  
サンプル音声を再生するボタンを連打してみるとわかりやすいと思います。

設定が表示されない場合は、 `機能設定` でその機能が有効になっているかどうかをご確認ください。  
また、よくある質問として **揺れの検知時の音声は `揺れの検出を有効にする` 設定が有効でない場合再生されません**。 `強震モニタ` 設定をご確認ください。

### テンプレートについて

一部音声については条件に応じて再生するファイルを変更することができます。

例えば、 `緊急地震速報受信` の `{int}: 最大震度[？,0,1,...,6-,6+,7]` については、 `{int}` に発表された緊急地震速報の震度が入ります。  
`C:\eew_{int}.wav` と指定されていた場合、予想最大震度3の緊急地震速報が発表されたときには `C:\eew_3.wav` を再生しようとします。  
この置き換えはいくつでも書くことができるため、 `C:\eew\{int}\{int}.wav` といった指定も可能です。

パラメータは固定になってしまいますが、サンプル音声にも対応していますので、動作確認などでも使用してみてください。

### 優先度について

ソースコード以外には記載されていませんが、音声には優先度が存在しており、優先度の高い音声の再生に失敗したり、無効になっている場合は優先度の低い音声を再生しようとします。  
例えば、 `緊急地震速報受信(初回)` に `{int}.wav` を指定して、震度3のときに `3.wav` が存在しない場合は `緊急地震速報受信` を再生しようとします。

優先度は以下のようになっています。

- 緊急地震速報
    1. 緊急地震速報受信(初回/最終/キャンセル)
    1. 緊急地震速報受信
- 地震情報
    1. 震度の更新 / 地震情報の更新(訓練)
    1. 地震情報の更新
- 津波情報
    1. 津波情報の発表 / 警報･注意報の更新 / 解除
    1. 津波情報の更新

現状強震モニタの音声に優先度はありません。

### 設定例

津波情報の音声については比較的細く設定が可能になっており、以下のような音声を入れるとそれっぽくなると思います。

- 津波情報の発表  
  設定値: `new\{lv}.wav`
    - `new\fore.wav`: `津波予報が発表されました。`
    - `new\adv.wav`: `津波注意報が発表されました。`
    - `new\warn.wav`: `津波警報が発表されました。`
    - `new\major.wav`: `大津波警報が発表されました。`
- 警報･注意報の更新  
  設定値: `upgrade\{lv}.wav`
    - `upgrade\fore.wav`: `津波予報が発表されています。` (通常は再生されない音声)
    - `upgrade\adv.wav`: `津波注意報に引き上げられました。`
    - `upgrade\warn.wav`: `津波警報に引き上げられました。`
    - `upgrade\major.wav`: `大津波警報に引き上げられました。`
- 警報･注意報の解除  
  設定値: `downgrade\{lv}.wav`
    - `downgrade\none.wav`: `津波警報、注意報、予報は解除されました。`
    - `downgrade\fore.wav`: `津波警報、注意報は予報に引き下げられました。`
    - `downgrade\adv.wav`: `津波警報は注意報に引き下げられました。`
    - `downgrade\warn.wav`: `大津波警報は、津波警報に引き下げられました。`
    - `downgrade\major.wav`: `大津波警報が引き続き発表されています。` (通常は再生されない音声)
- 津波情報の更新  
  設定値: `updated.wav`
    - `updated.wav`: `津波情報が更新されました。`

## 現在地を地図上に表示する

現状では正式に現在地を表示する機能は存在していませんが、 `緊急地震速報` 設定の `SignalNow Professional` 連携機能を有効にした上で、
`設定された所在地(予想地点)を地図上に表示する` 設定からSNPに設定された所在地を地図上に表示することができます。

## 配信･録画で使用する

このアプリは比較的新しい描画方式を採用しているため、 OBS などにおいてデフォルトの設定でキャプチャできないことがあります。  
OBS で ウィンドウキャプチャ を使用している場合は `キャプチャ方法` を `Windows 10(1903以降)` にしてご利用ください。

複数の情報を別ウィンドウで表示させる場合は、ショートカットやコマンドラインを使用して `KyoshinEewViewer.exe -s 機能名` と指定して起動させることで、
`機能設定` に関わらず指定した機能のみを起動することができます。  
![image](https://gyazo.ingen084.net/data/3a174ac2966f82cd2278b1b334d638f4.png)

現時点では

- 強震モニタ: `kyoshin-monitor`
- 地震情報: `earthquake`
- 雨雲レーダー: `radar`
- 津波情報: `tsunami`

が指定できますので、複数の情報を録画したい場合などはご活用ください。  
**`DM-D.S.S` 連携を有効にしている場合、WS接続数が起動した機能の数増加しますのでご注意ください**。

## アップデートは積極的にお願いします

このアプリはアップデートを積極的に行っています。  
アップデータが起動しなかったりなどの不具合をよく発生させてしまい申し訳ないのですが、安定性や情報の正確性に関わる更新もありますので、
**更新がある場合はなるべく早く、積極的に更新をお願い致します。**

![image](https://gyazo.ingen084.net/data/0bd789d8b27269faa7ad75b52d40ce6a.png)

## おわり

音声機能以外思ったより書くことなかったですね！  
ブログ更新半年振りになってしまった、文章作成スキルを磨くためにももう少し更新頻度を上げていきたいと思います。  
アプリ自体もやる気が続く限りちまちまとアップデートは続けていきますので今後ともよろしくお願いいたします。

## おまけ

ちなみに今後のアップデートでは以下の機能を予定しています。

- 他のアプリケーションやサービスと連携した緊急地震速報の到達予想時刻と予想震度の表示
    - 法律的な観点からアプリ内では計算できないため、他のアプリケーションやサービスと連携することで表示する予定です。が、連携先は未定です。
- みちびき を使用したオフライン環境での情報表示
- 台風情報の表示

アプリ名の変更も計画していたりします。 `for ingen` って文法思いっきり間違ってるし…。

![image](https://gyazo.ingen084.net/data/acb6e8975d45690079690b06e25ed9d2.png)  
うるせえｗ
